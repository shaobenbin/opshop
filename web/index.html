<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<title>OpsHop // TERMINAL_V3.0</title>
	<link rel="stylesheet" href="/static/css/style.css">
	<script src="/static/lib/vue.global.js"></script>
	<script src="/static/lib/Sortable.min.js"></script>
	<script src="/static/lib/vuedraggable.umd.min.js"></script>
	<!-- ÔºÅÔºÅÔºÅÂøÖÈ°ªÂ¢ûÂä†‰∏ãÈù¢Ëøô‰∏ÄË°å ÔºÅÔºÅÔºÅ -->
	<script src="/static/js/components/NodeModal.js"></script>
</head>
<body>
<div id="app" style="display: contents;">
	<aside class="sidebar">
		<div class="sidebar-header">OPSHOP</div>
		<div class="lang-switcher">
			<span :class="['lang-btn', lang === 'zh' ? 'active' : '']" @click="setLang('zh')">‰∏≠</span>
			<span :class="['lang-btn', lang === 'en' ? 'active' : '']" @click="setLang('en')">EN</span>
		</div>
		<div style="flex:1; overflow-y:auto;">
			<div v-for="ws in config.workspaces" :key="ws.id"
				 :class="['ws-item', currentWsId === ws.id ? 'active' : '']" @click="currentWsId = ws.id">
				üìÅ {{ ws.name }}
			</div>
		</div>
		<div style="padding:20px; border-top:1px solid var(--border);">
			<button class="btn" style="width:100%" @click="addWorkspace">+ NEW_WS</button>
		</div>
	</aside>

	<main class="main">
		<div class="dashboard-header" v-if="currentWorkspace">
			<h1>{{ currentWorkspace.name }}</h1>
<!--			<button class="btn btn-primary" @click="saveConfig">{{ t('sync_disk') }}</button>-->
		</div>

		<div class="grid" v-if="currentWorkspace">
			<node-card
				v-for="node in currentWorkspace.nodes"
				:key="node.id"
				:node="node"
				:t="t"
				@edit-node="editNode"
				@edit-app="openAppEditor"
				@add-app="addApp"
				@delete-node="deleteNode"
				@delete-app="deleteApp">
			</node-card>
			<div class="add-unit-placeholder" @click="addNode"
				 style="height:60px; border:1px dashed #333; display:flex; align-items:center; justify-content:center; cursor:pointer; color:#444;">
				[ + {{ t('add_node') }} ]
			</div>
		</div>
	</main>

	<app-modal v-if="editingApp" :app="editingApp" :t="t" @close="editingApp = null" @save="saveAppEdit"></app-modal>
	<!-- NodeModal ‰πüÂèØ‰ª•‰æùÊ≠§Á±ªÊé®ÊãÜÂá∫... -->
	<!-- ÁªÑ‰ª∂ÊåÇËΩΩÁÇπ -->
	<node-modal
		v-if="editingNode"
		:node="editingNode"
		:t="t"
		@close="editingNode = null"
		@save="saveNodeEdit">
	</node-modal>
</div>

<!-- ‰∏öÂä°ËÑöÊú¨Âä†ËΩΩ -->
<script src="/static/js/i18n.js"></script>
<script src="/static/js/components/NodeCard.js"></script>
<script src="/static/js/components/AppModal.js"></script>
<script src="/static/js/app.js"></script>
</body>
</html>
